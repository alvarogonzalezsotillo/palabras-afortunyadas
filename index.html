<!DOCTYPE html>
<html>
    <head>
        <title>Palabras anagramadas</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    </head>
    <body>

        <div id="ui">
            <input id="palabra" type="text" name="palabra" value="" placeholder="Anagrama" />
            <input id="botonPalabra" type="button" value="Busca anagramas"  disabled="true"/>
        </div>    

        <div id="uifrase">
            <input id="frase" type="text" name="frase" value="" placeholder="Frase" />
            <select id="selectFrase" type="text" name="selectFrase" value="" placeholder="Frase" >
                <option  value="1">1 letra</option>
                <option  value="2">2 letras</option>
                <option  value="3">3 letras</option>
                <option  value="4">4 letras</option>
                <option  value="5">5 letras</option>
                <option  value="6">6 letras</option>
                <option  value="7">7 letras</option>
                <option  value="8">8 letras</option>
                <option  value="9">9 letras</option>
                <option  value="10">10 letras</option>
                <option  value="11">11 letras</option>
                <option  value="12">12 letras</option>
                <option  value="13">13 letras</option>
                <option  value="14">14 letras</option>
                <option  value="15">15 letras</option>
                <option  value="16">16 letras</option>
                <option  value="17">17 letras</option>
                <option  value="18">18 letras</option>
                <option  value="19">19 letras</option>
                <option  value="10">20 letras</option>
            </select>

            <input id="botonFrase" type="button" value="Busca anagramas en la frase"  disabled="true"/>
        </div>    

        
        <div id="output">
        </div>

        
        <script type="text/javascript">
         function log(msg){
             console.log(msg);
             e("output").innerHTML += ("<pre>" + msg + "</pre>");
         }
         function e(id){
             return document.getElementById(id);
         }
         let visibleFromScala = {}
         log( "Cargando corpus...");
         visibleFromScala.worker = new Worker("./palabras/js/src/main/js/prueba-worker.js");

         visibleFromScala.worker.onmessage = function(msg){
             let m = msg.data
             if( m == "Corpus cargado" ){
                 //e("botonFrase").disabled = false;
                 e("botonPalabra").disabled = false;
                 e("output").innerHTML = "";
                 log( "Corpus cargado");
             }
             else{
                 e("botonPalabra").disabled = false;
                 e("botonPalabra").value = "Busca anagramas";
                 
                 log( "Se han econtrado " + m.length + " coincidencias"  );
                 for( let i = 0 ; i < m.length ; i++ ){
                     log( "  " + m[i] );
                 }
             }
         };
         
         function enviar(p){
             log( "Envío palabra: " + p );
             setTimeout( () => visibleFromScala.worker.postMessage(p), 1 );
         }
         
         e("botonPalabra").onclick = function(){
             e("botonPalabra").disabled = true;
             e("botonPalabra").value = "Buscando...";
             let palabra = e("palabra").value;
             e("output").innerHTML = "";
             enviar(palabra);
         }
         
        </script>

        <script type="text/javascript">
         // creo la variable exports para que no falle el modulo creado por scalajs
         exports = {};
         require = function(m){
             console.log("Módulo no cargado: " + m);
         }

        </script>
        
        <!-- Include JavaScript dependencies, webjars -->
        <script type="text/javascript" src="./palabras/js/target/scala-2.11/palabras-jsdeps.js"></script>

        <!-- Include Scala.js compiled code, generated with fastOptJS|fullOptJS in sbt -->
        <script type="text/javascript" src="./palabras/js/target/scala-2.11/palabras-fastopt.js"></script>

    </body>
</html>
